{
  "version": 3,
  "sources": ["../../src/scripts/topic.js"],
  "sourcesContent": ["/**\n * @typedef {{ roadmapId: string }} TopicConfig\n */\nexport class Topic {\n  /**\n   * @param {TopicConfig} config\n   */\n  constructor(config) {\n    this.config = config;\n\n    this.handleCloseTopic = this.handleCloseTopic.bind(this);\n    this.handleLoadTopic = this.handleLoadTopic.bind(this);\n    this.init = this.init.bind(this);\n  }\n\n  fetchTopicHtml(roadmapId, groupId) {\n    const topicPartial = groupId.replace(/^\\d+-/, '').replaceAll(/:/g, '/');\n    const fullUrl = `/${roadmapId}/${topicPartial}/`;\n\n    return fetch(fullUrl)\n      .then((res) => {\n        return res.text();\n      })\n      .then((topicHtml) => {\n        // It's full HTML with page body, head etc\n        // We only need the inner HTML of the #topic-content\n        const node = new DOMParser().parseFromString(topicHtml, 'text/html');\n\n        return node.querySelector('#topic-content');\n      });\n  }\n\n  handleCloseTopic(e) {\n    if (e.target.closest('#topic-content-content')) {\n      return;\n    }\n\n    e.stopPropagation();\n\n    document.querySelector('#topic-content-overlay').classList.add('hidden');\n  }\n\n  handleLoadTopic(e) {\n    const targetGroup = e.target.closest('g') || {};\n    const groupId = targetGroup.dataset ? targetGroup.dataset.groupId : '';\n    if (!groupId) {\n      return;\n    }\n\n    e.stopPropagation();\n\n    if (/^ext_link/.test(groupId)) {\n      window.open(`https://${groupId.replace('ext_link:', '')}`);\n      return;\n    }\n\n    document.querySelector('#topic-content-overlay').classList.remove('hidden');\n\n    this.fetchTopicHtml(this.config.roadmapId, groupId)\n      .then((content) => {\n        document\n          .querySelector('#topic-content-content')\n          .replaceChildren(content);\n      })\n      .catch(console.error);\n  }\n\n  init() {\n    window.addEventListener('click', this.handleCloseTopic);\n    window.addEventListener('click', this.handleLoadTopic);\n  }\n}\n\n/**\n * @param {TopicConfig} config\n */\nwindow.initTopic = function (config) {\n  const topic = new Topic(config);\n  topic.init();\n};\n"],
  "mappings": "MAGO,IAAMA,EAAN,KAAY,CAIjB,YAAYC,EAAQ,CAClB,KAAK,OAASA,EAEd,KAAK,iBAAmB,KAAK,iBAAiB,KAAK,IAAI,EACvD,KAAK,gBAAkB,KAAK,gBAAgB,KAAK,IAAI,EACrD,KAAK,KAAO,KAAK,KAAK,KAAK,IAAI,CACjC,CAEA,eAAeC,EAAWC,EAAS,CACjC,IAAMC,EAAeD,EAAQ,QAAQ,QAAS,EAAE,EAAE,WAAW,KAAM,GAAG,EAChEE,EAAU,IAAIH,KAAaE,KAEjC,OAAO,MAAMC,CAAO,EACjB,KAAMC,GACEA,EAAI,KAAK,CACjB,EACA,KAAMC,GAGQ,IAAI,UAAU,EAAE,gBAAgBA,EAAW,WAAW,EAEvD,cAAc,gBAAgB,CAC3C,CACL,CAEA,iBAAiBC,EAAG,CACdA,EAAE,OAAO,QAAQ,wBAAwB,IAI7CA,EAAE,gBAAgB,EAElB,SAAS,cAAc,wBAAwB,EAAE,UAAU,IAAI,QAAQ,EACzE,CAEA,gBAAgBA,EAAG,CACjB,IAAMC,EAAcD,EAAE,OAAO,QAAQ,GAAG,GAAK,CAAC,EACxCL,EAAUM,EAAY,QAAUA,EAAY,QAAQ,QAAU,GACpE,GAAI,EAACN,EAML,IAFAK,EAAE,gBAAgB,EAEd,YAAY,KAAKL,CAAO,EAAG,CAC7B,OAAO,KAAK,WAAWA,EAAQ,QAAQ,YAAa,EAAE,GAAG,EACzD,MACF,CAEA,SAAS,cAAc,wBAAwB,EAAE,UAAU,OAAO,QAAQ,EAE1E,KAAK,eAAe,KAAK,OAAO,UAAWA,CAAO,EAC/C,KAAMO,GAAY,CACjB,SACG,cAAc,wBAAwB,EACtC,gBAAgBA,CAAO,CAC5B,CAAC,EACA,MAAM,QAAQ,KAAK,EACxB,CAEA,MAAO,CACL,OAAO,iBAAiB,QAAS,KAAK,gBAAgB,EACtD,OAAO,iBAAiB,QAAS,KAAK,eAAe,CACvD,CACF,EAKA,OAAO,UAAY,SAAUT,EAAQ,CACrB,IAAID,EAAMC,CAAM,EACxB,KAAK,CACb",
  "names": ["Topic", "config", "roadmapId", "groupId", "topicPartial", "fullUrl", "res", "topicHtml", "e", "targetGroup", "content"]
}
