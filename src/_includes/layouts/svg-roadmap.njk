{% extends 'layouts/base.njk' %}

{% block headerAssets %}
  {{ super() }}

  {% set css %}
    {% include "styles/roadmap.css" %}
  {% endset %}

  <style>{{ css | cssmin | safe }}</style>
{% endblock %}

{% block main %}
  {{ super() }}

  <div id='roadmap-svg' class='mt-5'>
    {% include "components/loader.njk" %}
  </div>
{% endblock %}

{# Adds the assets for the footer #}
{% block footerAssets %}
  {{ super() }}

  <script src='/assets/roadmap-renderer.js'></script>
  <script src='/assets/renderer.js'></script>
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      renderRoadmap("{{ page.fileSlug }}")
        .then(function(svg) {
          document.getElementById('roadmap-svg').replaceChildren(svg);
        })
        .catch(console.error);
    });

    window.addEventListener('click', function (e) {
      const targetGroup = e.target.closest('g') || {};
      const groupId = targetGroup.dataset ? targetGroup.dataset.groupId : '';
      if (!groupId) {
        return;
      }

      if (/^ext_link/.test(groupId)) {
        window.open(`https://${groupId.replace('ext_link:', '')}`);
        return;
      }

      
    });
  </script>
{% endblock %}
