import{h as o,T as E,p as I}from"./hooks.module.da6d90ff.js";import{T as i}from"./constants.007bcfeb.js";import{a as w}from"./js.cookie.cf83ad76.js";import{S as T}from"./Spinner.a1a765f7.js";import{o as e}from"./jsxRuntime.module.760e3403.js";import"./preact.module.e54f245b.js";function U(){const[y,c]=o(""),[S,k]=o(""),[d,u]=o(""),[m,p]=o(""),[f,g]=o(""),[N,l]=o(!1),[r,h]=o(),j=n=>{n.preventDefault(),l(!0);const a=new Headers;a.append("Content-Type","application/json"),a.append("Cookie",`${i}=${w.get(i)}`),fetch("http://localhost:8080/v1-update-profile",{method:"POST",credentials:"include",headers:a,body:JSON.stringify({name:y,github:d===""?void 0:d,linkedin:m===""?void 0:m,website:f===""?void 0:f})}).then(async t=>{const s=await t.json();if(t.ok)return s;throw new Error(s.message)}).then(t=>{if(l(!1),c(t.name),k(t.email),t.links){const{github:s,linkedin:b,website:x}=t.links;u(s||""),p(b||""),g(x||"")}v(),h({type:"success",message:"Profile updated successfully"})}).catch(t=>{l(!1),h({type:"error",message:t.message||"Something went wrong"})})},v=E(async()=>{l(!0);const n=new Headers;n.append("Content-Type","application/json"),n.append("Cookie",`${i}=${w.get(i)}`);try{const a=await fetch("http://localhost:8080/v1-me",{method:"POST",credentials:"include",headers:n}),t=await a.json();if(t.status===401&&(w.remove(i),window.location.href="/login"),a.ok){if(c(t.name),k(t.email),t.links){const{github:s,linkedin:b,website:x}=t.links;u(s||""),p(b||""),g(x||"")}}else throw new Error(t.message)}catch(a){h({type:"error",message:a?.message||"Something went wrong"})}l(!1)},[]);return I(()=>{v()},[]),e("form",{onSubmit:j,children:[e("h2",{className:"text-3xl font-bold sm:text-4xl",children:"Update Profile"}),e("p",{className:"mt-2",children:"Manage settings for your roadmap.sh profile"}),e("div",{className:"mt-8 space-y-4",children:[e("div",{className:"flex w-full flex-col",children:[e("label",{for:"name",className:'text-sm leading-none text-slate-500 after:text-red-400 after:content-["*"]',children:"Name"}),e("input",{type:"text",name:"name",id:"name",className:"mt-2 block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none transition duration-150 ease-in-out placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",required:!0,placeholder:"John Doe",value:y,onInput:n=>c(n.target.value)})]}),e("div",{className:"flex w-full flex-col",children:[e("label",{for:"email",className:'text-sm leading-none text-slate-500 after:text-red-400 after:content-["*"]',children:"Email"}),e("input",{type:"email",name:"email",id:"email",className:"mt-2 block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none transition duration-150 ease-in-out placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",required:!0,disabled:!0,placeholder:"john@example.com",value:S})]}),e("div",{className:"flex w-full flex-col",children:[e("label",{for:"github",className:"text-sm leading-none text-slate-500",children:"Github"}),e("input",{type:"text",name:"github",id:"github",className:"mt-2 block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none transition duration-150 ease-in-out placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://github.com/username",value:d,onInput:n=>u(n.target.value)})]}),e("div",{className:"flex w-full flex-col",children:[e("label",{for:"linkedin",className:"text-sm leading-none text-slate-500",children:"LinkedIn"}),e("input",{type:"text",name:"linkedin",id:"linkedin",className:"mt-2 block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none transition duration-150 ease-in-out placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://www.linkedin.com/in/username/",value:m,onInput:n=>p(n.target.value)})]}),e("div",{className:"flex w-full flex-col",children:[e("label",{for:"website",className:"text-sm leading-none text-slate-500",children:"Website"}),e("input",{type:"text",name:"website",id:"website",className:"mt-2 block w-full appearance-none rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none transition duration-150 ease-in-out placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://example.com",value:f,onInput:n=>g(n.target.value)})]}),r&&e("div",{className:`mt-2 rounded-lg p-2 ${r.type==="error"?"bg-red-100 text-red-700":r.type==="success"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:r.message}),e("button",{className:"!mt-5 inline-flex h-10 min-w-[120px] items-center justify-center rounded-lg border border-slate-300 bg-black p-2 px-4 text-sm font-medium text-white outline-none transition duration-150 ease-in-out focus:ring-2 focus:ring-black focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-60",type:"submit",disabled:N,children:N?e(T,{className:"text-white"}):"Update"})]})]})}export{U as default};
