<!doctypehtml><html lang=en><meta charset=utf-8><title>Session Based Authentication - roadmap.sh</title><meta content="Learn what is Session Based Authentication and how to implement it in Node.js" name=description><meta content="Kamran Ahmed" name=author><meta content="roadmap, developer roadmaps, developer roadmap, how to become a developer, frontend developer roadmap, frontend developer roadmap 2022, backend developer roadmap, backend developer roadmap 2022, sre roadmap, sre roadmap 2022, devops roadmap, devops roadmap 2022, android developer roadmap, android developer roadmap 2022, dba roadmap, dba roadmap 2022, blockchain developer roadmap, blockchain developer roadmap 2022, qa roadmap, qa roadmap 2022, qa engineer roadmap, qa engineer roadmap 2022, software architect roadmap, software architect roadmap 2022, asp.net core developer roadmap, asp.net core developer roadmap 2022, react developer roadmap, react developer roadmap 2022, angular developer roadmap, angular developer roadmap 2022, vue developer roadmap, vue developer roadmap 2022, node.js developer roadmap, node.js developer roadmap 2022, javascript developer roadmap, javascript developer roadmap 2022, python developer roadmap, python developer roadmap 2022, go developer roadmap, go developer roadmap 2022, java developer roadmap, java developer roadmap 2022, design system roadmap, design system roadmap 2022, software design roadmap, software design roadmap 2022" name=keywords><meta content=width=device-width,user-scalable=yes,initial-scale=1.0,maximum-scale=3.0,minimum-scale=1.0 name=viewport><meta content=en http-equiv=Content-Language><meta content="Session Based Authentication - roadmap.sh" property=og:title><meta content="Learn what is Session Based Authentication and how to implement it in Node.js" property=og:description><meta content=https://roadmap.sh/assets/images/brand-square.png property=og:image><meta content=https://roadmap.sh property=og:url><meta content=website property=og:type><meta content=roadmap.sh property=og:site_name><meta content=https://facebook.com/kamranahmedse property=article:publisher><meta content="Kamran Ahmed" property=article:author><meta content=summary name=twitter:card><meta content=@kamranahmedse name=twitter:site><meta content="Session Based Authentication - roadmap.sh" name=twitter:title><meta content="Learn what is Session Based Authentication and how to implement it in Node.js" name=twitter:description><meta content=https://roadmap.sh/brand-square.png name=twitter:image><meta content=roadmap.sh name=twitter:image:alt><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=black-translucent name=apple-mobile-web-app-status-bar-style><link href=/assets/manifest/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><meta content=#101010 name=msapplication-TileColor><meta content=#848a9a name=theme-color><link href=/assets/manifest/icon32.png rel=icon sizes=32x32 type=image/png><link href=/assets/manifest/icon16.png rel=icon sizes=16x16 type=image/png><link rel="shortcut icon" href=/assets/manifest/favicon.ico type=image/x-icon><link href=/assets/manifest/favicon.ico rel=icon type=image/x-icon><link href=/assets/manifest/manifest.json rel=manifest><link href=/styles/main.css rel=stylesheet><link href=/ rel=preconnect><link as=font href=/assets/fonts/balsamiq.woff2 rel=preload type=font/woff2><meta content=noindex name=robots><style>div[class*="language-"],
code[class*='language-'],
pre[class*='language-'] {
  color: #9efeff;
  direction: ltr;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;

  font-family: 'Operator Mono', 'Fira Code', Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  font-weight: 400;
  font-size: .95rem;
  line-height: 1.3;

  letter-spacing: 0.5px;
  text-shadow: 0 1px #222245;

  margin-bottom: 25px !important;
}

pre[class*='language-']::-moz-selection,
pre[class*='language-'] ::-moz-selection,
code[class*='language-']::-moz-selection,
code[class*='language-'] ::-moz-selection,
pre[class*='language-']::selection,
pre[class*='language-'] ::selection,
code[class*='language-']::selection,
code[class*='language-'] ::selection {
  color: inherit;
  background: #a599e9;
}

code:not([class]) {
  padding: 2px 4px;
  font-family: 'Operator Mono', 'Fira Code', Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  font-size: .875rem;
  background-color: #FAFAFA;
  border: 1px solid #EAEAEA;
  border-radius: 4px;
}

/* Code blocks. */
pre[class*='language-'] {
  padding: 1em;
  border-radius: 4px;

  margin: 0.5em 0;
  overflow: auto;
}

:not(pre) > code[class*='language-'],
pre[class*='language-'] {
  background: #1e1e3f;
}

/* Inline code */
:not(pre) > code[class*='language-'] {
  padding: 0.1em;
  border-radius: 0.3em;
}

.token {
  font-weight: 400;
}

.token.comment,
.token.prolog,
.token.cdata {
  color: #b362ff;
}

.token.delimiter,
.token.keyword,
.token.selector,
.token.important,
.token.atrule {
  color: #ff9d00;
}

.token.operator,
.token.attr-name {
  color: rgb(255, 180, 84);
}

.token.punctuation {
  color: #ffffff;
}

.token.boolean {
  color: rgb(255, 98, 140);
}

.token.tag,
.token.tag .punctuation,
.token.doctype,
.token.builtin {
  color: rgb(255, 157, 0);
}

.token.entity,
.token.symbol {
  color: #6897bb;
}

.token.number {
  color: #ff628c;
}

.token.property,
.token.constant,
.token.variable {
  color: #ff628c;
}

.token.string,
.token.char {
  color: #a5ff90;
}

.token.attr-value,
.token.attr-value .punctuation {
  color: #a5c261;
}

.token.attr-value .punctuation:first-child {
  color: #a9b7c6;
}

.token.url {
  color: #287bde;
  text-decoration: underline;
}

.token.function {
  color: rgb(250, 208, 0);
}

.token.regex {
  background: #364135;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}

.token.inserted {
  background: #00ff00;
}

.token.deleted {
  background: #ff000d;
}

code.language-css .token.property,
code.language-css .token.property + .token.punctuation {
  color: #a9b7c6;
}

code.language-css .token.id {
  color: #ffc66d;
}

code.language-css .token.selector > .token.class,
code.language-css .token.selector > .token.attribute,
code.language-css .token.selector > .token.pseudo-class,
code.language-css .token.selector > .token.pseudo-element {
  color: #ffc66d;
}

.token.class-name {
  color: #fb94ff;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  background: none;
}

pre .line-highlight,
pre .line-highlight.line-highlight,
pre > code.line-highlight {
  margin-top: 36px;
  background: linear-gradient(to right, rgba(179, 98, 255, 0.17), transparent);
}

pre .line-highlight:before,
pre > code.line-highlight:before,
pre .line-highlight[data-end]:after,
pre > code.line-highlight[data-end]:after {
  content: '';
}</style><body class=relative><div class="bg-slate-900 text-white py-5 sm:py-8"><nav class="container flex items-center justify-between"><a class="font-medium text-lg flex items-center text-white hover:text-blue-200" href=/> <svg viewbox="0 0 283 283" fill=none height=30 width=30 xmlns=http://www.w3.org/2000/svg><path d="M0 39C0 17.46 17.46 0 39 0h205c21.539 0 39 17.46 39 39v205c0 21.539-17.461 39-39 39H39c-21.54 0-39-17.461-39-39V39Z" fill=#000></path><path d="M121.215 210.72c-1.867.56-4.854 1.12-8.96 1.68-3.92.56-8.027.84-12.32.84-4.107 0-7.84-.28-11.2-.84-3.174-.56-5.88-1.68-8.12-3.36-2.24-1.68-4.014-3.92-5.32-6.72-1.12-2.987-1.68-6.813-1.68-11.48v-84c0-4.293.746-7.933 2.24-10.92 1.68-3.173 4.013-5.973 7-8.4 2.986-2.427 6.626-4.573 10.92-6.44 4.48-2.053 9.24-3.827 14.28-5.32a106.176 106.176 0 0 1 15.68-3.36 95.412 95.412 0 0 1 16.24-1.4c8.96 0 16.053 1.773 21.28 5.32 5.226 3.36 7.84 8.96 7.84 16.8 0 2.613-.374 5.227-1.12 7.84-.747 2.427-1.68 4.667-2.8 6.72-3.92 0-7.934.187-12.04.56-4.107.373-8.12.933-12.04 1.68-3.92.747-7.654 1.587-11.2 2.52-3.36.747-6.254 1.68-8.68 2.8v95.48Zm45.172-22.4c0-7.84 2.426-14.373 7.28-19.6 4.853-5.227 11.48-7.84 19.88-7.84 8.4 0 15.026 2.613 19.88 7.84 4.853 5.227 7.28 11.76 7.28 19.6 0 7.84-2.427 14.373-7.28 19.6-4.854 5.227-11.48 7.84-19.88 7.84-8.4 0-15.027-2.613-19.88-7.84-4.854-5.227-7.28-11.76-7.28-19.6Z" fill=#fff></path></svg> <span class=ml-3>roadmap.sh</span> </a><ul class="hidden sm:flex space-x-5"><li><a class=hover:text-blue-200 href=/roadmaps>Roadmaps</a><li><a class=hover:text-blue-200 href=/guides>Guides</a><li><a class=hover:text-blue-200 href=/videos>Videos</a><li><a class="py-2 px-4 text-sm font-regular rounded-full bg-gradient-to-r from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white" href=/signup> Subscribe </a></ul><button class="text-gray-400 hover:text-gray-50 block sm:hidden cursor-pointer" id=show-mobile-navigation><svg class="h-5 w-5" viewbox="0 0 24 24" aria-hidden=true focusable=false><path d="M 3 5 A 1.0001 1.0001 0 1 0 3 7 L 21 7 A 1.0001 1.0001 0 1 0 21 5 L 3 5 z M 3 11 A 1.0001 1.0001 0 1 0 3 13 L 21 13 A 1.0001 1.0001 0 1 0 21 11 L 3 11 z M 3 17 A 1.0001 1.0001 0 1 0 3 19 L 21 19 A 1.0001 1.0001 0 1 0 21 17 L 3 17 z" fill=currentColor></path></svg></button><div class="fixed top-0 bottom-0 left-0 right-0 z-40 bg-slate-900 flex items-center hidden" id=mobile-navigation><button class="text-gray-400 hover:text-gray-50 block cursor-pointer absolute top-6 right-6 cursor-pointer" id=close-mobile-navigation><svg class="w-5 h-5" viewbox="0 0 20 20" aria-hidden=true fill=currentColor xmlns=http://www.w3.org/2000/svg><path d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule=evenodd fill-rule=evenodd></path></svg></button><ul class="flex flex-col gap-2 md:gap-3 items-center w-full"><li><a class="text-lg md:text-lg hover:text-blue-300" href=/roadmaps>Roadmaps</a><li><a class="text-lg md:text-lg hover:text-blue-300" href=/guides>Guides</a><li><a class="text-lg md:text-lg hover:text-blue-300" href=/videos>Videos</a><li><a class="text-lg md:text-lg text-red-300 hover:text-red-400" href=/signup>Subscribe</a></ul></div></nav></div><div class="bg-white border-b py-12"><div class="container text-center"><p class="text-gray-400 flex items-center justify-center"><a class="font-medium hover:text-gray-600 inline-flex items-center hover:underline" href=https://twitter.com/kamranahmedse target=_blank> <img class="w-5 h-5 inline mr-2 rounded-full" src=/assets/authors/kamranahmedse.jpeg> Kamran Ahmed </a> <span class=mx-1.5>·</span> <span class=capitalize>textual Guide</span> <span class=mx-1.5>·</span> <a class="text-blue-400 hover:text-blue-500 hover:underline" href=https://github.com/kamranahmedse/roadmap.sh/tree/master/src/guides/session-based-authentication.md target=_blank>Improve this Guide</a><h1 class="text-5xl my-3.5 font-bold">Session Based Authentication</h1><p class="text-gray-400 text-md">Learn what is Session Based Authentication and how to implement it in Node.js</div></div><div class="bg-gray-50 py-10"><div class=container><main id=main-content><p class=mb-4>HTTP is the internet protocol that standardizes how clients and servers interact with each other. When you open a website, among other things, HTTP is the protocol that helps load the website in the browser.<h2 class="text-xl sm:text-3xl font-bold mb-2 mt-7" id=http-is-stateless tabindex=-1>HTTP is Stateless</h2><p class=mb-4>HTTP is a stateless protocol which means that each request made from the client to the server is treated as a standalone request; neither the client nor the server keeps track of the subsequent requests. Sessions allow you to change that; with sessions, the server has a way to associate some information with the client so that when the same client requests the server, it can retrieve that information.<p class=mb-4>In this guide, we will learn what is Session-Based Authentication and how to implement it in Node.js. We also have a separate <a class="font-bold underline" href=/guides/session-authentication>visual guide on Session-Based Authentication</a> as well that explains the topic visually.<h2 class="text-xl sm:text-3xl font-bold mb-2 mt-7" id=what-is-session-based-authentication%3F tabindex=-1>What is Session-Based Authentication?</h2><p class=mb-4>Session-based authentication is a stateful authentication technique where we use sessions to keep track of the authenticated user. Here is how Session Based Authentication works:<ul class="mb-5 ml-7 list-disc"><li class=mb-1>User submits the login request for authentication.<li class=mb-1>Server validates the credentials. If the credentials are valid, the server initiates a session and stores some information about the client. This information can be stored in memory, file system, or database. The server also generates a unique identifier that it can later use to retrieve this session information from the storage. Server sends this unique session identifier to the client.<li class=mb-1>Client saves the session id in a cookie and this cookie is sent to the server in each request made after the authentication.<li class=mb-1>Server, upon receiving a request, checks if the session id is present in the request and uses this session id to get information about the client.</ul><p class=mb-4>And that is how session-based authentication works.<h2 class="text-xl sm:text-3xl font-bold mb-2 mt-7" id=session-based-authentication-in-node.js tabindex=-1>Session-Based Authentication in Node.js</h2><p class=mb-4>Now that we know what session-based authentication is, let’s see how we can implement session-based authentication in Node.js.<p class=mb-4>Please note that, for the sake of simplicity, I have intentionally kept the project strictly relevant to the Session Based Authentication and have left out a lot of details that a production-ready application may require. Also, if you don’t want to follow along, project <a class="font-bold underline" href=https://github.com/kamranahmedse/node-session-auth-example>codebase can be found on GitHub</a>.<p class=mb-4>First things first, create an empty directory that will be holding our application.<pre class=language-shell><code class=language-shell><span class="token function">mkdir</span> session-auth-example</code></pre><p class=mb-4>Now run the following command to setup a sample <code>package.json</code> file:<pre class=language-shell><code class=language-shell><span class="token function">npm</span> init <span class="token parameter variable">-y</span></code></pre><p class=mb-4>Next, we need to install the dependencies:<pre class=language-shell><code class=language-shell><span class="token function">npm</span> <span class="token function">install</span> express express-session</code></pre><p class=mb-4><code>Express</code> is the application framework, and <code>express-session</code> is the package that helps work with sessions easily.<h3 class="text-lg sm:text-2xl font-bold mb-0 mt-3" id=setting-up-the-server tabindex=-1>Setting up the server</h3><p class=mb-4>Now create an <code>index.js</code> file at the root of the project with the following content:<pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> sessions <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">sessions</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token string">"some secret"</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">cookie</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">maxAge</span><span class="token operator">:</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token comment">// 24 hours</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// @todo register routes</span><br><br>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Server Running at port 3000</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p class=mb-4>The important piece to note here is the <code>express-session</code> middleware registration which automatically handles the session initialization, cooking parsing and session data retrieval, and so on. In our example here, we are passing the following configuration options:<ul class="mb-5 ml-7 list-disc"><li class=mb-1><code>secret</code>: This is used to sign the session ID cookie. Using a secret that cannot be guessed will reduce the ability to hijack a session.<li class=mb-1><code>cookie</code>: Object containing the configuration for session id cookie.<li class=mb-1><code>resave</code>: Forces the session to be saved back to the session store, even if the session data was never modified during the request.<li class=mb-1><code>saveUninitialized</code>: Forces an “uninitialized” session to be saved to the store, i.e., saves a session to the store even if the session was not initiated.</ul><p class=mb-4>Another important option is <code>store</code> which we can configure to change how/where the session data is stored on the server. By default, this data is stored in the memory, i.e., <code>MemoryStore</code>.<p class=mb-4>Look at the <a class="font-bold underline" href=https://github.com/expressjs/session>express-session documentation</a> to learn more about the available options.<h3 class="text-lg sm:text-2xl font-bold mb-0 mt-3" id=creating-handlers tabindex=-1>Creating Handlers</h3><p class=mb-4>Create a directory called the <code>handlers</code> at the project’s root. This is the directory where we will be placing all the route-handling functions.<p class=mb-4>Now let’s create the homepage route, which will show the welcome message and a link to log out for the logged-in users and redirect to the login screen for the logged-out users. Create a file at <code>handlers/home.js</code> with the following content.<pre class=language-javascript><code class=language-javascript>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">HomeHandler</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userid<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/HTML'</span><span class="token punctuation">)</span><br>  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &LTh1>Welcome back </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&LT/h1><br>    &LTa href="/logout">Logout&LT/a><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p class=mb-4>At the top of this function, you will notice the check <code>req.session.userid</code>. <code>req.session</code> is automatically populated using the session cookie by the <code>express-session</code> middleware that we registered earlier. <code>req.session.userid</code> is one of the data fields that we will set to store the <code>userid</code> of the logged in user.<p class=mb-4>Next, we need to register this handler with a route. Open the <code>index.js</code> file at the root of the project and register the following route:<pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> HomeHandler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./handlers/home.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> HomeHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p class=mb-4>Next, we have the login page, redirecting the user to the home screen if the user is logged in or showing the login form. Create a file at <code>handlers/login.js</code> with the following content:<pre class=language-javascript><code class=language-javascript>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">LoginHandler</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userid<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/HTML'</span><span class="token punctuation">)</span><br>  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &LTh1>Login&LT/h1><br>    &LTform method="post" action="/process-login"><br>      &LTinput type="text" name="username" placeholder="Username" /> &LTbr><br>      &LTinput type="password" name="password" placeholder="Password" /> &LTbr><br>      &LTbutton type="submit">Login&LT/button><br>    &LT/form><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p class=mb-4>Again, at the top of the function, we are simply checking if we have <code>userid</code> in the session (which means the user is logged in). If the user is logged in, we redirect them to the homepage; if not, we show the login screen. In the login form, we have the method of <code>post</code>, and we submit the form to <code>/process-login</code>. Please note that, for the sake of simplicity, we have a simple HTML string returned in the response, but in a real-world application, you will probably have a separate view file.<p class=mb-4>Let’s first register this page and then implement <code>/process-login</code> endpoint. Open the <code>index.js</code> file from the root of the project and register the following route:<pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> LoginHandler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./handlers/login.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> LoginHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p class=mb-4>Next, we have to implement the functionality to process the login form submissions. Create a file at <code>handlers/process-login.js</code> with the following content:<pre class=language-javascript><code class=language-javascript>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">processLogin</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username <span class="token operator">!==</span> <span class="token string">'admin'</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password <span class="token operator">!==</span> <span class="token string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>'Invalid username or password<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>userid <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">;</span><br><br>  res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p class=mb-4>As you can see, we are simply checking that the username and password should both be <code>admin</code> and <code>admin</code> for a user to authenticate successfully. Upon finding valid credentials, we set the <code>userid</code> in the session by updating <code>req.session.userid</code>. Similarly, you can set any data in the session. For example, if we wanted to store the user role, we would do the following:<pre class=language-javascript><code class=language-javascript>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>role <span class="token operator">=</span> <span class="token string">'admin'</span></code></pre><p class=mb-4>And later access this value out of the session anywhere in the subsequent requests.<p class=mb-4>Register this route in the <code>index.js</code> file at the root of the project:<pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> ProcessLoginHandler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./handlers/process-login.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/process-login'</span><span class="token punctuation">,</span> ProcessLoginHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p class=mb-4>Finally, we have the logout functionality. Create a file at <code>handlers/logout.js</code> with the following content:<pre class=language-javascript><code class=language-javascript>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Logout</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span><br>  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p class=mb-4>We reset the session by calling <code>req.session.destroy()</code> and then redirecting the user to the homepage. Register the logout handler in the <code>index.js</code> file using the following:<pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> LogoutHandler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./handlers/logout.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/logout'</span><span class="token punctuation">,</span> LogoutHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 class="text-xl sm:text-3xl font-bold mb-2 mt-7" id=running-the-application tabindex=-1>Running the Application</h2><p class=mb-4>Open the <code>package.json</code> file and register the <code>start</code> script as follows:<pre class=language-javascript><code class=language-javascript><span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>  <span class="token string-property property">"start"</span><span class="token operator">:</span> <span class="token string">"node index.js"</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre><p class=mb-4>Now you can start the application by running the following command:<pre class=language-shell><code class=language-shell><span class="token function">npm</span> run start</code></pre><p class=mb-4>Now, if you open up your browser and visit the project at <code>http://localhost:3000</code> you will be able to see the Session-Based Authentication in action.</main></div></div><div class="py-6 sm:py-16 border-b border-t text-left sm:text-center bg-white"><div class="max-w-[600px] container"><h1 class="text-3xl sm:text-5xl font-bold">Open Source</h1><p class="text-gray-600 text-sm sm:text-lg leading-relaxed my-2.5 sm:my-5">The project is OpenSource, <a class="font-medium text-gray-600 hover:text-black underline underline-offset-2" href=https://github.com/search?o=desc&q=stars%3A%3E100000&s=stars&type=Repositories target=_blank>6th most starred project on GitHub</a> and is visited by hundreds of thousands of developers every month.<div class="block mb-1.5 sm:mb-0"><a class="inline-flex items-center group rounded-md relative" href=https://github.com/kamranahmedse/developer-roadmap target=_blank> <span class="inline-flex items-center border border-black py-1.5 px-3 rounded-lg text-sm group-hover:text-white group-hover:bg-black relative bg-white"> <div class="mr-1 -ml-1"><svg class="w-4 h-4 fill-current" viewbox="0 0 14 15" focusable=false height=15 width=14 xmlns=http://www.w3.org/2000/svg><path d="M6.99999 11.1515L2.88574 13.4545L3.80449 8.82984L0.342407 5.6285L5.02482 5.07317L6.99999 0.791504L8.97516 5.07317L13.6576 5.6285L10.1955 8.82984L11.1142 13.4545L6.99999 11.1515Z"></path></svg></div> <span class=lowercase>219K</span> <span class="ml-1.5 group-hover:hidden">GitHub Stars</span> <span class="ml-2 hidden group-hover:block">Star us on GitHub</span> </span> </a></div></div></div><div class="py-6 sm:py-16 pb-10 bg-slate-900 text-white"><div class=container><p class="text-gray-400 font-medium flex flex-col sm:flex-row gap-0 sm:gap-4 mb-8 sm:mb-14"><a class="px-2 py-1.5 border-b border-b-gray-700 sm:border-b-0 sm:py-0 sm:px-0 hover:text-white" href=/roadmaps>Roadmaps</a> <a class="px-2 py-1.5 border-b border-b-gray-700 sm:border-b-0 sm:py-0 sm:px-0 hover:text-white" href=/guides>Guides</a> <a class="px-2 py-1.5 border-b border-b-gray-700 sm:border-b-0 sm:py-0 sm:px-0 hover:text-white" href=/videos>Videos</a> <a class="px-2 py-1.5 border-b border-b-gray-700 sm:border-b-0 sm:py-0 sm:px-0 hover:text-white" href=/about>About</a> <a class="px-2 py-1.5 sm:border-b-0 sm:py-0 sm:px-0 hover:text-white" href=https://youtube.com/theroadmap?sub_confirmation=1 target=_blank>YouTube</a><div class=max-w-[500px]><p class="flex items-center text-md"><a class="font-medium text-lg inline-flex items-center hover:text-gray-100 text-gray-400" href=/> <svg viewbox="0 0 283 283" fill=none height=30 width=30 xmlns=http://www.w3.org/2000/svg><path d="M0 39C0 17.46 17.46 0 39 0h205c21.539 0 39 17.46 39 39v205c0 21.539-17.461 39-39 39H39c-21.54 0-39-17.461-39-39V39Z" fill=#000></path><path d="M121.215 210.72c-1.867.56-4.854 1.12-8.96 1.68-3.92.56-8.027.84-12.32.84-4.107 0-7.84-.28-11.2-.84-3.174-.56-5.88-1.68-8.12-3.36-2.24-1.68-4.014-3.92-5.32-6.72-1.12-2.987-1.68-6.813-1.68-11.48v-84c0-4.293.746-7.933 2.24-10.92 1.68-3.173 4.013-5.973 7-8.4 2.986-2.427 6.626-4.573 10.92-6.44 4.48-2.053 9.24-3.827 14.28-5.32a106.176 106.176 0 0 1 15.68-3.36 95.412 95.412 0 0 1 16.24-1.4c8.96 0 16.053 1.773 21.28 5.32 5.226 3.36 7.84 8.96 7.84 16.8 0 2.613-.374 5.227-1.12 7.84-.747 2.427-1.68 4.667-2.8 6.72-3.92 0-7.934.187-12.04.56-4.107.373-8.12.933-12.04 1.68-3.92.747-7.654 1.587-11.2 2.52-3.36.747-6.254 1.68-8.68 2.8v95.48Zm45.172-22.4c0-7.84 2.426-14.373 7.28-19.6 4.853-5.227 11.48-7.84 19.88-7.84 8.4 0 15.026 2.613 19.88 7.84 4.853 5.227 7.28 11.76 7.28 19.6 0 7.84-2.427 14.373-7.28 19.6-4.854 5.227-11.48 7.84-19.88 7.84-8.4 0-15.027-2.613-19.88-7.84-4.854-5.227-7.28-11.76-7.28-19.6Z" fill=#fff></path></svg> <span class=ml-2>roadmap.sh</span> </a> <span class="text-gray-400 mx-2">by</span> <a class="bg-blue-500 text-sm py-1 px-1.5 font-regular hover:bg-blue-600 rounded-md" href=https://twitter.com/kamranahmedse target=_blank> <span class="hidden sm:inline">@kamranahmedse</span> <span class="inline sm:hidden">Kamran Ahmed</span> </a><p class="text-gray-500 my-4">Community created roadmaps, articles, resources and journeys to help you choose your path and grow in your career.<div class="text-gray-500 text-sm"><p>© roadmap.sh <span class=mx-1.5>·</span> <a class=hover:text-white href=/about>FAQs</a> <span class=mx-1.5>·</span> <a class=hover:text-white href=/terms>Terms</a> <span class=mx-1.5>·</span> <a class=hover:text-white href=/privacy>Privacy</a></div></div></div></div><script src=/scripts/navigation.js></script>